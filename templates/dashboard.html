{% extends "base.html" %}
{% block content %}
<div class="card p-4 mb-4">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h5 class="text-muted">Foreign Server Status</h5>
            {% if server_ip %}
                <h2 class="text-success fw-bold"><i class="fas fa-check-circle"></i> Connected</h2>
                <span class="badge bg-secondary">{{ server_ip }}</span>
            {% else %}
                <h2 class="text-danger fw-bold"><i class="fas fa-times-circle"></i> Disconnected</h2>
            {% endif %}
        </div>
        <div>
            {% if not server_ip %}
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#connectModal">Connect</button>
            {% else %}
                <a href="{{ url_for('dashboard.disconnect_server') }}" class="btn btn-outline-danger">Disconnect</a>
            {% endif %}
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-3">
        <div class="card p-3 text-center h-100">
            <i class="fas fa-bolt fa-3x text-primary mb-3"></i>
            <h5>Hysteria 2</h5>
            <button class="btn btn-primary w-100 mt-2" data-bs-toggle="modal" data-bs-target="#hysteriaModal">Install</button>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card p-3 text-center h-100">
            <i class="fas fa-wind fa-3x text-info mb-3"></i>
            <h5>Slipstream</h5>
            <button class="btn btn-info text-white w-100 mt-2" data-bs-toggle="modal" data-bs-target="#slipstreamModal">Install</button>
        </div>
    </div>
</div>

<div class="modal fade" id="connectModal" tabindex="-1">
    <div class="modal-dialog">
        <form action="{{ url_for('dashboard.connect_server') }}" method="POST" class="modal-content">
            <div class="modal-header"><h5>Connect Server</h5></div>
            <div class="modal-body">
                <input name="ip" class="form-control mb-2" placeholder="IP" required>
                <input name="username" class="form-control mb-2" value="root" required>
                <input name="password" type="password" class="form-control mb-2" placeholder="Pass" required>
            </div>
            <div class="modal-footer"><button class="btn btn-primary">Connect</button></div>
        </form>
    </div>
</div>

<div class="modal fade" id="hysteriaModal" tabindex="-1">
    <div class="modal-dialog">
        <form action="{{ url_for('tunnels.install_hysteria') }}" method="POST" class="modal-content">
            <div class="modal-header"><h5>Install Hysteria</h5></div>
            <div class="modal-body">
                <input type="number" name="tunnel_port" class="form-control mb-2" placeholder="Tunnel Port (UDP)" required>
                <input type="text" name="forward_ports" class="form-control mb-2" placeholder="Forward Ports (e.g. 8443)" required>
            </div>
            <div class="modal-footer"><button class="btn btn-primary">Install</button></div>
        </form>
    </div>
</div>

<div class="modal fade" id="slipstreamModal" tabindex="-1">
    <div class="modal-dialog">
        <form action="{{ url_for('tunnels.install_slipstream') }}" method="POST" class="modal-content">
            <div class="modal-header"><h5>Install Slipstream</h5></div>
            <div class="modal-body">
                <div class="alert alert-warning small">Build takes 5-10 mins.</div>
                <input name="tunnel_port" class="form-control mb-2" value="8853" placeholder="Tunnel Port">
                <input name="client_port" class="form-control mb-2" value="8443" placeholder="Client Port">
                <input name="dest_port" class="form-control mb-2" value="8443" placeholder="Dest Port">
                <input name="domain" class="form-control mb-2" value="update.googleapis.com">
            </div>
            <div class="modal-footer"><button class="btn btn-info text-white">Build & Install</button></div>
        </form>
    </div>
</div>
{% endblock %}